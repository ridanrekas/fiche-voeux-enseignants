<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fiche de V≈ìux Enseignants</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h2>üìù Fiche de v≈ìux des enseignants ‚Äì D√©partement d'√âlectronique (2025-2026)</h2>
  <p><strong>Instructions :</strong><br>
    Veuillez remplir vos choix de mati√®res √† enseigner pour l'ann√©e 2025-2026 (semestres impairs uniquement).<br>
    Les 3 premiers choix sont <strong>obligatoires</strong>, les 2 derniers sont <strong>facultatifs</strong>.<br>
    Pour chaque choix, s√©lectionnez la sp√©cialit√©, le semestre, la mati√®re, et les types d‚Äôenseignement (Cours, TD, TP).
  </p>

  <form id="voeuxForm">
    <fieldset>
      <legend>üë§ Informations personnelles</legend>
      <label>Nom :
        <input name="nom" id="nom" required>
      </label><br><br>
      <label>Pr√©nom :
        <input name="prenom" id="prenom" required>
      </label><br><br>
      <label>Email universitaire :
        <input name="email" id="email" type="email" required pattern=".+@univ-annaba\.dz">
      </label>
    </fieldset>

    <div id="choix-container"></div>

    <button type="submit">‚úÖ Envoyer mes v≈ìux</button>
    <p id="confirmationMessage" style="color: green;"></p>
  </form>

  <script>
    // G√©n√©rer dynamiquement 5 choix
    const container = document.getElementById("choix-container");

    for (let i = 1; i <= 5; i++) {
      const obligatoire = i <= 3;
      const bloc = document.createElement("fieldset");
      bloc.innerHTML = `
        <legend>Choix ${i} ${obligatoire ? "(obligatoire)" : "(facultatif)"}</legend>
        <label>Sp√©cialit√© :
          <input name="specialite_${i}" required=${obligatoire}>
        </label><br>
        <label>Semestre :
          <input name="semestre_${i}" required=${obligatoire}>
        </label><br>
        <label>Mati√®re :
          <input name="matiere_${i}" required=${obligatoire}>
        </label><br>
        <label><input type="checkbox" name="types_${i}" value="Cours"> Cours</label>
        <label><input type="checkbox" name="types_${i}" value="TD"> TD</label>
        <label><input type="checkbox" name="types_${i}" value="TP"> TP</label>
      `;
      container.appendChild(bloc);
    }

    // Envoi vers Apps Script
    document.getElementById("voeuxForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const form = e.target;
      const nom = document.getElementById("nom").value.trim();
      const prenom = document.getElementById("prenom").value.trim();
      const email = document.getElementById("email").value.trim();
      const voeux = [];

      for (let i = 1; i <= 5; i++) {
        const specialite = form[`specialite_${i}`].value.trim();
        const semestre = form[`semestre_${i}`].value.trim();
        const matiere = form[`matiere_${i}`].value.trim();
        const types = Array.from(form.querySelectorAll(`input[name="types_${i}"]:checked`)).map(cb => cb.value);

        if (specialite && semestre && matiere) {
          voeux.push({ specialite, semestre, matiere, types });
        }
      }

      const data = { nom, prenom, email, voeux };

      // Ton vrai lien Apps Script
      const scriptURL = 'https://script.google.com/macros/s/AKfycbwJp_ZAYKfPc_DTqzIk2HuPTa8X4kIKd5QfWtGpSJBHxrcY1mtrzU4yTAQ1dvmI12Vn/exec';

      fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(data),
        headers: {
          'Content-Type': 'application/json'
        }
      })
      .then(response => response.text())
      .then(responseText => {
        document.getElementById("confirmationMessage").textContent = "‚úÖ V≈ìux envoy√©s avec succ√®s !";
        form.reset();
      })
      .catch(error => {
        document.getElementById("confirmationMessage").textContent = "‚ùå Une erreur est survenue : " + error.message;
      });
    });
  </script>
</body>
</html>
